# _icarus
# vim: ft=sh

# Enable autoloading
compdef icarus

_icarus() {
  local -a commands
  local -a amazon_args builder_args macos_args unison_args

  commands=(
    '--amazon:Utilities for Amazon environment'
    '--builder:Utilities for software development'
    '--macos:Utilities for macOS'
    '--unison:Utilities to manage Unison daemon'
    '--help:Show help'
    '-h:Show help'
  )

  amazon_args=(
    '--auth-init:Run midway authentication'
    '-a:Run midway authentication'

    '--midway-cookie:Check cookies validity'
    '-c:Check cookies validity'

    '--devdsk-formation:Run DevDsk Formation'
    '-d:Run DevDsk Formation'

    '--update-hosts:Update /etc/hosts'
    '-s:Update /etc/hosts'

    '--update-hosts-d:Install a daemon for hosts update'
    '-u:Install a daemon for hosts update'

    '--brazil-setup:Create case-sensitive volumes'
    '-b:Create case-sensitive volumes'

    '--spurdog-ro:Check membership for Spurdog Program'
    '-r:Check membership for Spurdog Program'
  )

  builder_args=(
    '--python-package-init:Initiate a new Python package'
    '-p:Initiate a new Python package'

    '--dotfiles-update:Update dotfiles from repo'
    '-d:Update dotfiles from repo'
  )

  macos_args=(
    '--find-unencrypted-volumes:Find all unencrypted volumes'
    '-f:Find all unencrypted volumes'

    '--make-encrypted-volume:Make an encrypted APFS volume'
    '-c:Make an encrypted APFS volume'

    '--encrypt-volume:Encrypt an existing APFS volume'
    '-e:Encrypt an existing APFS volume'

    '--mount-volume:Mount the specified volume'
    '-m:Mount the specified volume'

    '--mount-at-startup:Install a daemon to mount at startup'
    '-l:Install a daemon to mount at startup'
  )

  unison_args=(
    '--status:Check Unison status'
    '-i:Check Unison status'

    '--start:Start Unison sync'
    '-s:Start Unison sync'

    '--stop:Stop Unison sync'
    '-k:Stop Unison sync'

    '--clear-locks:Clear Unison locks'
    '-c:Clear Unison locks'

    '--start-at-startup:Install a daemon to start Unison at startup'
    '-l:Install a daemon to start Unison at startup'
  )

  case "$words[2]" in
    --amazon)
      _describe 'args' amazon_args
      ;;
    --builder)
      _describe 'args' builder_args
      ;;
    --macos)
      _describe 'args' macos_args
      ;;
    --unison)
      _describe 'args' unison_args
      ;;
    *)
      _describe 'commands' commands
      ;;
  esac
}

# Register the completion function
compdef _icarus icarus
